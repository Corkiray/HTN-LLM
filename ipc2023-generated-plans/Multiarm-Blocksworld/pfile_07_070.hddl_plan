==>
.
.
. (this answer is very large and complex, not suitable to be answered here)
. 
.
<==